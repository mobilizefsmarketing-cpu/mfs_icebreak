<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ ë²½ëŒê¹¨ê¸° í€´ì¦ˆ ğŸ®</title> 
<style>
  body {
    margin: 0;
    background: radial-gradient(circle at 30% 30%, #04122a, #000);
    color: white;
    font-family: "Pretendard", sans-serif;
    overflow: hidden;
    touch-action: none;

    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    height: 100vh;
  }

  canvas {
    display: block;
    background: radial-gradient(circle at 30% 30%, #0f2b52, #000);
    border: 3px solid #3af;
    border-radius: 16px;
    box-shadow: 0 0 40px rgba(0, 180, 255, 0.4);
    margin-top: 5vh;
  }

  #status {
    position: fixed;
    top: 10px;
    right: 12px;
    font-size: 1em;
    background: rgba(0,0,0,0.5);
    padding: 6px 10px;
    border-radius: 12px;
    z-index: 100;
  }

  #quizPopup {
    display: none;
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    z-index: 10;
  }

  #quizPopup .box {
    background: white;
    color: #111;
    border-radius: 16px;
    padding: 20px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 0 20px rgba(255,255,255,0.5);
    animation: popup 0.4s ease;
  }

  @keyframes popup {
    from { transform: scale(0.8); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  #quizPopup button {
    padding: 10px 18px;
    margin: 8px;
    border: none;
    border-radius: 8px;
    font-size: 1.1em;
    cursor: pointer;
  }

  #quizPopup .o { background: #3af; color: white; }
  #quizPopup .x { background: #f33; color: white; }
  #quizPopup .next { background: #3c3; color: white; display: none; }

  #timer {
    font-size: 1.2em;
    margin-bottom: 10px;
    color: #007bff;
    font-weight: bold;
  }

  #logoScreen {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 20;
  }

  #logoScreen h1 {
    color: #3af;
    font-size: 2em;
    text-align: center;
    animation: fadeInOut 3s ease forwards;
  }

  @keyframes fadeInOut {
    0% { opacity: 0; transform: scale(0.9); }
    20% { opacity: 1; transform: scale(1); }
    80% { opacity: 1; }
    100% { opacity: 0; transform: scale(1.1); }
  }
</style>
</head>
<body>
<div id="logoScreen"><h1>ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ì½”ë¦¬ì•„ ì œê³µ</h1></div>
<canvas id="gameCanvas"></canvas>
<div id="status">ì ìˆ˜: 0 | ë¼ì´í”„: 3</div>

<div id="quizPopup">
  <div class="box">
    <div id="timer">ë‚¨ì€ ì‹œê°„: 10ì´ˆ</div>
    <h2 id="quizQuestion">ì§ˆë¬¸ì´ ë‚˜ì˜µë‹ˆë‹¤</h2>
    <div>
      <button class="o" onclick="handleAnswer(true)">O</button>
      <button class="x" onclick="handleAnswer(false)">X</button>
    </div>
    <button class="next" id="nextQuizBtn" onclick="closeQuiz()">ê³„ì†í•˜ê¸° â–¶</button>
  </div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const status = document.getElementById("status");

// âœ… ë°˜ì‘í˜• í¬ê¸° ì„¤ì •
function resizeCanvas() {
  const scale = Math.min(window.innerWidth / 800, window.innerHeight / 600);
  canvas.width = 800 * scale;
  canvas.height = 600 * scale;
  ctx.scale(scale, scale);
}
resizeCanvas();
window.addEventListener("resize", () => location.reload());

// ê²Œì„ ë³€ìˆ˜
let state = { running: false, paused: false, score: 0, lives: 3 };
const paddle = { width: 90, height: 15, x: 355, y: 560, speed: 9, movingLeft: false, movingRight: false };
const ball = { x: 400, y: 540, dx: 3.5, dy: -3.5, radius: 12 }; // âœ… ì†ë„â†“, í¬ê¸°â†‘
let bricks = [];

const quizList = [
  { q:"ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ëŠ” í”„ë‘ìŠ¤ íšŒì‚¬ì´ë‹¤?", a:true },
  { q:"ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ëŠ” ë¥´ë…¸ì½”ë¦¬ì•„ì˜ ê³µì‹ê¸ˆìœµíŒŒíŠ¸ë„ˆì‚¬ì´ë‹¤?", a:true },
  { q:"ê³ ê°ì´ ì¬êµ¬ë§¤ì‹œ ìºì‹œë°±í˜œíƒì´ ìˆë‹¤?", a:true },
  { q:"ì”ê°€ë³´ì¥í˜• ìƒí’ˆì€ ì›” ë‚©ì…ê¸ˆì´ ì •ì•¡ë¶ˆë³´ë‹¤ ë‚®ë‹¤?", a:true },
  { q:"ì°¨ëŸ‰ì„ êµ¬ë§¤í•˜ë©´ ê¸ˆìœµ ì„œë¹„ìŠ¤ë¥¼ ë¬´ì¡°ê±´ ë°›ì•„ì•¼ í•œë‹¤?", a:false },
  { q:"ëª¨ë“  ìƒí’ˆì€ ì˜¨ë¼ì¸ìœ¼ë¡œë§Œ ì‹ ì²­ ê°€ëŠ¥í•˜ë‹¤?", a:false }
];
let currentQuiz=0, quizTimer, timeLeft=10;

function createLogoBricks(){
  const brickW=45, brickH=18;
  const cx=400, cy=200;
  const outer=200, inner=120;
  for(let y=60; y<360; y+=brickH+4){
    for(let x=60; x<740; x+=brickW+4){
      const dx=x-cx, dy=y-cy;
      const dist=Math.sqrt(dx*dx+dy*dy);
      const angle=Math.atan2(dy,dx);
      const circlePart = dist<outer && dist>inner && (angle<-0.5 || angle>0.5);
      const slash = Math.abs(dy+dx*0.5)<20;
      if(circlePart||slash) bricks.push({x,y,w:brickW,h:brickH,color:slash?"#ff3c00":"#00baff",visible:true});
    }
  }
}
createLogoBricks();

function drawBall(){
  const grad = ctx.createRadialGradient(ball.x, ball.y, 2, ball.x, ball.y, 14);
  grad.addColorStop(0,"#fff");
  grad.addColorStop(1,"#3af");
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI*2);
  ctx.fillStyle=grad; ctx.fill(); ctx.closePath();
}
function drawPaddle(){
  const grad = ctx.createLinearGradient(paddle.x, paddle.y, paddle.x, paddle.y+paddle.height);
  grad.addColorStop(0,"#5cf"); grad.addColorStop(1,"#39f");
  ctx.beginPath();
  ctx.roundRect(paddle.x,paddle.y,paddle.width,paddle.height,8);
  ctx.fillStyle=grad; ctx.fill(); ctx.closePath();
}
function drawBricks(){
  bricks.forEach(b=>{
    if(b.visible){
      const grad = ctx.createLinearGradient(b.x,b.y,b.x+b.w,b.y+b.h);
      grad.addColorStop(0,b.color); grad.addColorStop(1,"#fff");
      ctx.beginPath(); ctx.roundRect(b.x,b.y,b.w,b.h,6);
      ctx.fillStyle=grad; ctx.fill(); ctx.closePath();
    }
  });
}
function collisionDetection(){
  bricks.forEach(b=>{
    if(b.visible && ball.x>b.x && ball.x<b.x+b.w && ball.y>b.y && ball.y<b.y+b.h){
      b.visible=false; ball.dy=-ball.dy; state.score+=100;
    }
  });
}
function resetBall(){ ball.x=400; ball.y=540; ball.dx=3.5; ball.dy=-3.5; }

// âœ… í„°ì¹˜ ì¡°ì‘: í™”ë©´ ì–´ë””ì„œë“  íŒ¨ë“¤ ì´ë™ ê°€ëŠ¥
document.addEventListener("touchmove", e=>{
  const touch = e.touches[0];
  const rect = canvas.getBoundingClientRect();
  const relativeX = (touch.clientX - rect.left) / (rect.width / 800);
  paddle.x = relativeX - paddle.width/2;
});

document.addEventListener("keydown", e=>{
  if(e.key==="ArrowLeft") paddle.movingLeft=true;
  if(e.key==="ArrowRight") paddle.movingRight=true;
});
document.addEventListener("keyup", e=>{
  if(e.key==="ArrowLeft") paddle.movingLeft=false;
  if(e.key==="ArrowRight") paddle.movingRight=false;
});

function startQuizLoop(){ setInterval(()=>{ if(state.running && !state.paused) showQuiz(); },15000); }
function showQuiz(){
  if(currentQuiz>=quizList.length) return;
  state.paused=true;
  const quiz=quizList[currentQuiz];
  document.getElementById("quizQuestion").innerText=quiz.q;
  document.getElementById("quizPopup").style.display="flex";
  document.getElementById("nextQuizBtn").style.display="none";
  document.querySelector("#quizPopup .o").style.display="inline-block";
  document.querySelector("#quizPopup .x").style.display="inline-block";
  timeLeft=10;
  document.getElementById("timer").innerText=`ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
  quizTimer=setInterval(()=>{
    timeLeft--;
    document.getElementById("timer").innerText=`ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
    if(timeLeft<=0){ clearInterval(quizTimer); handleAnswer(null,true); }
  },1000);
}
function handleAnswer(ans,timeout=false){
  clearInterval(quizTimer);
  const correct = quizList[currentQuiz].a;
  document.querySelector("#quizPopup .o").style.display="none";
  document.querySelector("#quizPopup .x").style.display="none";
  if(ans === correct && !timeout){
    alert("ì •ë‹µ! ğŸ‰ +200ì ");
    state.score += 200;
  } else {
    alert(timeout ? "ì‹œê°„ ì´ˆê³¼ ğŸ˜… -1ë¼ì´í”„, -100ì " : "í‹€ë ¸ì–´ìš” ğŸ˜… -1ë¼ì´í”„, -100ì ");
    state.score -= 100; state.lives--;
    ball.dx *= 1.1; // âœ… ì†ë„ ì¦ê°€ ì™„í™”
    ball.dy *= 1.1;
  }
  document.getElementById("nextQuizBtn").style.display="inline-block";
  updateStatus();
}
function closeQuiz(){
  document.getElementById("quizPopup").style.display="none";
  currentQuiz++; state.paused=false;
  document.querySelector("#quizPopup .o").style.display="inline-block";
  document.querySelector("#quizPopup .x").style.display="inline-block";
}
function updateStatus(){ status.innerText=`ì ìˆ˜: ${state.score} | ë¼ì´í”„: ${state.lives}`; }

function draw(){
  if(!state.running) return;
  ctx.clearRect(0,0,800,600);
  drawBricks(); drawBall(); drawPaddle();
  if(!state.paused){
    if(paddle.movingLeft) paddle.x-=paddle.speed;
    if(paddle.movingRight) paddle.x+=paddle.speed;
    paddle.x=Math.max(0,Math.min(800-paddle.width,paddle.x));
    ball.x+=ball.dx; ball.y+=ball.dy;
    if(ball.x+ball.radius>800 || ball.x-ball.radius<0) ball.dx=-ball.dx;
    if(ball.y-ball.radius<0) ball.dy=-ball.dy;
    if(ball.y+ball.radius>paddle.y && ball.x>paddle.x && ball.x<paddle.x+paddle.width){
      let hitPos=(ball.x-(paddle.x+paddle.width/2))/(paddle.width/2);
      ball.dx=hitPos*4.5; // âœ… ë°˜ì‚¬ ì‹œ ì†ë„ ì¡°ì •
      ball.dy=-Math.abs(ball.dy);
    }
    if(ball.y>600){ state.lives--; updateStatus();
      if(state.lives<=0){ status.innerHTML="ê²Œì„ ì˜¤ë²„ ğŸ˜¢ <button onclick='location.reload()'>ì¬ë„ì „</button>"; state.running=false; }
      else resetBall();
    }
    collisionDetection();
  }
  updateStatus();
  requestAnimationFrame(draw);
}
setTimeout(()=>{
  document.getElementById("logoScreen").style.display="none";
  state.running=true; draw(); startQuizLoop();
},3000);
</script>
</body>
</html>
