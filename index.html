<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ì½”ë¦¬ì•„ ì•„ì´ìŠ¤ ë¸Œë ˆì´ì»¤ ğŸ®</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: radial-gradient(circle at center, #021425, #000);
    color: white;
    font-family: "Pretendard", sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    flex-direction: column;
  }
  #intro, #quiz, #gameOver, #startScreen {
    position: absolute;
    text-align: center;
    width: 100%;
    top: 40%;
    color: #4db8ff;
    font-weight: bold;
  }
  #intro h1 {
    font-size: 1.4em;
    margin: 0.4em 0;
    line-height: 1.5em;
  }
  #startButton {
    background: #00bfff;
    color: white;
    font-size: 1.1em;
    border: none;
    padding: 12px 28px;
    border-radius: 10px;
    cursor: pointer;
    transition: 0.3s;
  }
  #startButton:hover { background: #0099cc; }
  canvas {
    background: radial-gradient(circle at 30% 30%, #041a35, #000);
    border: 3px solid #1e90ff;
    border-radius: 12px;
    display: block;
    margin: auto;
    touch-action: none;
  }
  #quiz {
    display: none;
    font-size: 1.2em;
    color: white;
    top: 30%;
  }
  #quiz button {
    background: #00bfff;
    color: white;
    font-size: 1.3em;
    border: none;
    padding: 14px 26px;
    margin: 0 20px;
    border-radius: 12px;
    cursor: pointer;
    transition: 0.3s;
  }
  #quiz button:hover {
    background: #0099cc;
  }
  #timer {
    color: #ff4444;
    font-size: 1em;
    margin-top: 15px;
  }
  #scoreboard {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(0,0,0,0.6);
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 0.9em;
  }
  #gameOver {
    display: none;
    color: white;
    top: 40%;
  }
  #retryBtn {
    background: #ff5722;
    color: white;
    font-size: 1.1em;
    border: none;
    padding: 10px 20px;
    border-radius: 10px;
    cursor: pointer;
  }
</style>
</head>
<body>
  <div id="intro">
    <h1>ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ì½”ë¦¬ì•„</h1>
    <h1>ì•„ì´ìŠ¤ ë¸Œë ˆì´ì»¤</h1>
    <h1>ì œê³µ</h1>
  </div>

  <div id="startScreen" style="display:none;">
    <button id="startButton">ê²Œì„ ì‹œì‘í•˜ê¸°</button>
  </div>

  <canvas id="gameCanvas" width="400" height="500" style="display:none;"></canvas>
  <div id="scoreboard">ì ìˆ˜: 0 | ë¼ì´í”„: 3</div>

  <div id="quiz">
    <div id="quizQuestion"></div>
    <div style="margin-top:20px;">
      <button id="btnO">O</button>
      <button id="btnX">X</button>
    </div>
    <div id="timer"></div>
  </div>

  <div id="gameOver">
    <h2>ê²Œì„ ì˜¤ë²„!</h2>
    <button id="retryBtn">ì¬ë„ì „</button>
  </div>

<script>
  const intro = document.getElementById("intro");
  const startScreen = document.getElementById("startScreen");
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const scoreboard = document.getElementById("scoreboard");
  const quiz = document.getElementById("quiz");
  const quizQuestion = document.getElementById("quizQuestion");
  const timerDisplay = document.getElementById("timer");
  const btnO = document.getElementById("btnO");
  const btnX = document.getElementById("btnX");
  const gameOverScreen = document.getElementById("gameOver");
  const retryBtn = document.getElementById("retryBtn");

  let paddleWidth = 80, paddleHeight = 10;
  let ballRadius = 6;
  let x, y, dx, dy, paddleX;
  let rightPressed = false, leftPressed = false;
  let score = 0, lives = 3;
  let gameRunning = false;
  let quizTimer;
  let showQuizInterval;
  
  const brickRowCount = 8;
  const brickColumnCount = 10;
  const brickWidth = 35;
  const brickHeight = 15;
  const brickPadding = 4;
  const brickOffsetTop = 40;
  const brickOffsetLeft = 15;
  let bricks = [];

  const questions = [
    { q: "ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ëŠ” í”„ë‘ìŠ¤ íšŒì‚¬ë‹¤?", a: "O" },
    { q: "ê·¸ë‘ì½œë ˆì˜¤ìŠ¤ 26ë…„ ìƒì‚°ê¸°ì¤€ í• ë¶€ì›ê¸ˆì œí•œì€ 2500ë§Œì›ì´ë‹¤?", a: "O" },
    { q: "ëª¨ë¹Œë¼ì´ì¦ˆíŒŒì´ë‚¸ì…œì„œë¹„ìŠ¤ëŠ” ë¥´ë…¸ì½”ë¦¬ì•„ ê³µì‹ ê¸ˆìœµíŒŒíŠ¸ë„ˆì´ë‹¤?", a: "O" },
    { q: "ê¸ˆìœµìƒí’ˆ ê¸ˆë¦¬ëŠ” ëª¨ë‘ ë™ì¼í•˜ë‹¤?", a: "X" }
  ];

  function initBricks() {
    bricks = [];
    for(let c=0; c<brickColumnCount; c++) {
      bricks[c] = [];
      for(let r=0; r<brickRowCount; r++) {
        const isOrange = (r === c || r === c-1);
        bricks[c][r] = { x:0, y:0, status:1, color:isOrange ? "#ff5722" : "#00bfff" };
      }
    }
  }

  function drawBricks() {
    for(let c=0; c<brickColumnCount; c++) {
      for(let r=0; r<brickRowCount; r++) {
        if(bricks[c][r].status === 1) {
          const brickX = c*(brickWidth+brickPadding)+brickOffsetLeft;
          const brickY = r*(brickHeight+brickPadding)+brickOffsetTop;
          bricks[c][r].x = brickX;
          bricks[c][r].y = brickY;
          ctx.fillStyle = bricks[c][r].color;
          ctx.fillRect(brickX, brickY, brickWidth, brickHeight);
        }
      }
    }
  }

  function drawBall() {
    ctx.beginPath();
    ctx.arc(x, y, ballRadius, 0, Math.PI*2);
    ctx.fillStyle = "#66ccff";
    ctx.fill();
    ctx.closePath();
  }

  function drawPaddle() {
    ctx.beginPath();
    ctx.rect(paddleX, canvas.height - paddleHeight - 10, paddleWidth, paddleHeight);
    ctx.fillStyle = "#00bfff";
    ctx.fill();
    ctx.closePath();
  }

  function draw() {
    if(!gameRunning) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBricks();
    drawBall();
    drawPaddle();
    collisionDetection();

    if(x + dx > canvas.width-ballRadius || x + dx < ballRadius) dx = -dx;
    if(y + dy < ballRadius) dy = -dy;
    else if(y + dy > canvas.height - ballRadius - 10) {
      if(x > paddleX && x < paddleX + paddleWidth) {
        dy = -dy;
      } else {
        lives--;
        scoreboard.textContent = `ì ìˆ˜: ${score} | ë¼ì´í”„: ${lives}`;
        if(!lives) endGame();
        else resetBall();
      }
    }

    if(rightPressed && paddleX < canvas.width - paddleWidth) paddleX += 6;
    else if(leftPressed && paddleX > 0) paddleX -= 6;

    x += dx;
    y += dy;
    requestAnimationFrame(draw);
  }

  function collisionDetection() {
    for(let c=0; c<brickColumnCount; c++) {
      for(let r=0; r<brickRowCount; r++) {
        const b = bricks[c][r];
        if(b.status === 1) {
          if(x > b.x && x < b.x+brickWidth && y > b.y && y < b.y+brickHeight) {
            dy = -dy;
            b.status = 0;
            score += 10;
            scoreboard.textContent = `ì ìˆ˜: ${score} | ë¼ì´í”„: ${lives}`;
          }
        }
      }
    }
  }

  function resetBall() {
    x = canvas.width/2;
    y = canvas.height-30;
    dx = 3 * (Math.random() > 0.5 ? 1 : -1);
    dy = -3;
    paddleX = (canvas.width - paddleWidth) / 2;
  }

  function startGame() {
    score = 0; lives = 3;
    scoreboard.textContent = `ì ìˆ˜: ${score} | ë¼ì´í”„: ${lives}`;
    canvas.style.display = "block";
    gameOverScreen.style.display = "none";
    initBricks();
    resetBall();
    gameRunning = true;
    draw();
    showQuizInterval = setInterval(showQuiz, 10000);
  }

  function showQuiz() {
    const q = questions[Math.floor(Math.random()*questions.length)];
    quizQuestion.textContent = q.q;
    quiz.style.display = "block";
    let timeLeft = 10;
    timerDisplay.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}s`;
    clearInterval(quizTimer);
    quizTimer = setInterval(()=>{
      timeLeft--;
      timerDisplay.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}s`;
      if(timeLeft<=0){ checkAnswer(null,q.a); }
    },1000);

    btnO.onclick = ()=>checkAnswer("O",q.a);
    btnX.onclick = ()=>checkAnswer("X",q.a);
  }

  function checkAnswer(ans, correct) {
    clearInterval(quizTimer);
    quiz.style.display = "none";
    if(ans===correct) {
      score += 200;
    } else {
      score -= 100;
      lives--;
      dx *= 1.2; dy *= 1.2;
    }
    scoreboard.textContent = `ì ìˆ˜: ${score} | ë¼ì´í”„: ${lives}`;
    if(lives<=0) endGame();
  }

  function endGame() {
    clearInterval(showQuizInterval);
    gameRunning = false;
    quiz.style.display = "none";
    canvas.style.display = "none";
    gameOverScreen.style.display = "block";
  }

  document.addEventListener("keydown", e=>{
    if(e.key==="Right" || e.key==="ArrowRight") rightPressed=true;
    else if(e.key==="Left" || e.key==="ArrowLeft") leftPressed=true;
  });
  document.addEventListener("keyup", e=>{
    if(e.key==="Right" || e.key==="ArrowRight") rightPressed=false;
    else if(e.key==="Left" || e.key==="ArrowLeft") leftPressed=false;
  });

  canvas.addEventListener("touchmove", e=>{
    const rect = canvas.getBoundingClientRect();
    const touchX = e.touches[0].clientX - rect.left;
    paddleX = touchX - paddleWidth/2;
  });

  retryBtn.onclick = startGame;

  // ì¸íŠ¸ë¡œ â†’ 3ì´ˆ í›„ "ê²Œì„ ì‹œì‘í•˜ê¸°" í™”ë©´
  setTimeout(()=>{
    intro.style.display = "none";
    startScreen.style.display = "block";
  },3000);

  document.getElementById("startButton").onclick = ()=>{
    startScreen.style.display = "none";
    startGame();
  };
</script>
</body>
</html>
